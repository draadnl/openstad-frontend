<link rel="stylesheet" type="text/css" href="{{data.widget.OpenStadComponentsCdn}}/css/choices-guide.css"/>

<style>
 {{data.widget.formattedContainerStyles}}
 @media only screen and (max-width: 940px) {
   .sticky-placeholder {
     margin-top: 64px;
   }
 }
</style>

<script>
 
 // sticky
 document.addEventListener('osc-choices-guide-is-ready', function(event) {
	 setupStickyChoices();
 });
 function setupStickyChoices() {
	 var container = document.getElementById('{{data.widget.divId}}');
	 var element = document.getElementById('osc-choices-container-{{data.widget.divId}}');
	 var questiongroupdiv = document.querySelector('.osc-question-group');

	 if (container && element) {
		 var orgPos = element.style.position;
		 var orgTop = element.style.top;
		 var orgLeft = element.style.left;

		 function updateStickyStatus() {
			 var containerRect = container.getBoundingClientRect();
			 var elementRect = element.getBoundingClientRect();

			 var containerTop = window.pageYOffset + containerRect.top;
			 var containerBottom = containerTop + containerRect.height;
			 var elementHeight = elementRect.height;
			 var elementBottomPosition = window.pageYOffset + elementRect.top + elementHeight;
			 var absLeft = window.pageXOffset + elementRect.left;

			 if (window.pageYOffset > containerTop && elementBottomPosition < containerBottom) {
				 if (!element.classList.contains('sticky')) {
					 element.classList.add('sticky');
					 element.style.position = 'fixed';
					 element.style.top = "0px";
					 element.style.left = absLeft + 'px';

					 if (questiongroupdiv && !questiongroupdiv.classList.contains('sticky-placeholder')) {
						 questiongroupdiv.classList.add('sticky-placeholder');
					 }
				 }
			 } else {
				 if (element.classList.contains('sticky')) {
					 element.classList.remove('sticky');
					 element.style.position = orgPos;
					 element.style.top = orgTop;
					 element.style.left = orgLeft;

					 if (questiongroupdiv) {
						 questiongroupdiv.classList.remove('sticky-placeholder');
					 }
				 }
			 }
		 }

		 window.addEventListener('scroll', updateStickyStatus);
		 window.addEventListener('resize', function() {
			 orgLeft = element.style.left;
			 updateStickyStatus();
		 });
	 }
 }

</script>
<div id="{{data.widget.containerId}}" class="osc-component">
	<div class="{{data.widget.divId}}"></div>
</div>
