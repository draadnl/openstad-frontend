{% if activeResource %}
  {% if field.notExtraDataKey %}
  {% set fieldValue = activeResource[field.fieldKey] %}
  {% else %}
  {% set fieldValue = activeResource.extraData[field.fieldKey] %}
  {% endif %}
{% endif %}

{% if not fieldValue %}
  {% if data.query[field.fieldKey] %}
  {% set fieldValue = data.query[field.fieldKey] %}
  {% else %}
  {% set fieldValue = field.fieldValue %}
  {% endif %}
{% endif %}

{% set uniqueId = apos.utils.generateId() %}

<div class="checkbox-container">
  {% for option in field.fieldOptions %}
  <div class="checkbox">
    <input
      type="checkbox"
      {% if field.notExtraDataKey %}
      name="{{field.fieldKey}}"
      {% else %}
      name="extraData[{{field.fieldKey}}]"
      {% endif %}
      value="{{option.value}}"
      id="checkbox-{{uniqueId}}-{{loop.index}}-{{option.value}}"

      {% if fieldValue === option.value %}checked{% endif %}
    />

    <label for="checkbox-{{uniqueId}}-{{loop.index}}-{{option.value}}" class="checkbox-label">
       {{option.label}}
    </label>
  </div>
  {% endfor %}
</div>
