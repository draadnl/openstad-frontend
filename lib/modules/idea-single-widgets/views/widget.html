{% set idea = data.idea %}
{% set isOwner = data.openstadUser.id === idea.userId %}
{% set isOwnerOrAdmin =(isOwner or data.isAdmin) %}

{% import 'includes/numberplatebutton.html' as numberPlateButton %}

<div class="pageContent idea">
	<div id="title">
		<div>
			<div class="primary">
				{% if idea.extraData.images[0] %}
					<div class="image" style="background-image: url('{{idea.extraData.images[0]}}');"></div>
				{% elif idea.location %}
					<div class="image" style="background-image: url(
					'https://maps.googleapis.com/maps/api/streetview?size=1400x700&location={{idea.location.coordinates[0]}},{{idea.location.coordinates[1]}}&heading=151.78&key={{apos.settings.getOption('googleMapsApiKey')}}'
					);"></div>
				{% else %}
					<div class="image"></div>
				{% endif %}
				{% if idea.status == 'CLOSED' %}
					<div class="statusbalk {{idea.status}}">Reageer nu op dit agendapunt.</div>
				{% elif idea.status == 'DENIED' %}
					<div class="statusbalk {{idea.status}}">Dit idee is afgewezen</div>
				{% else %}
					<div class="statusbalk {{idea.status}}">Stem nu op dit idee</div>
				{% endif %}
				<!--
						 <div class="ranking {{idea.status}}"><div class="label">{{idea.ranking}}</div></div>
				-->
			</div>

			<div class="secondary">
				<div class="controls">

					<div class="ideaDuration {{idea.status}}">
						<h4>Status</h4>
						<div class="duration">
							{% if idea.status == 'CLOSED' %}
								<div>Reageer nu op dit agendapunt.</div>
							{% elif idea.status == 'DENIED' %}
								<div>Stemmen op dit voorstel is niet meer mogelijk.</div>
							{% elif idea.status == 'ACCEPTED' %}
								<div>Dit voorstel wordt besproken in de volgende vergadering!</div>
							{% elif idea.status == 'BUSY' %}
								<div>Dit voorstel wordt uitgevoerd. Lees op deze pagina over de voortgang.</div>
							{% elif idea.status == 'DONE' %}
								<div>Dit voorstel is uitgevoerd. Lees daar meer over op deze pagina.</div>
							{% else %}
								<div id="nog-xxx-om-te-stemmen"></div>
								<script>
									var endDate2 = new Date('{{idea.endDate}}');
									var daysLeft2 = parseInt( ( endDate2.getTime() - Date.now() ) / ( 24 * 60 * 60 * 1000) ) + 1;

								  document.getElementById('nog-xxx-om-te-stemmen').innerHTML = 'Nog '+ daysLeft2 +' dagen om te stemmen';
								</script>
							{% endif %}
						</div>
					</div>

					<div class="share">
						<h4>Deel dit idee</h4>
						<ul>
							<li><a class="facebook" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u={{idea.fullUrl | urlencode}}">Facebook</a></li>
							<li><a class="twitter"  target="_blank" href="https://twitter.com/home?status={{idea.fullUrl | urlencode}}">Twitter</a></li>
							<li><a class="email"    href="mailto:?subject={{'Idee voor ' + data.global.siteTitle + ': '+idea.title | urlencode}}&body={{idea.fullUrl | urlencode}}">Email</a></li>
							<li><a class="whatsapp desktop" target="_blank" href="https://api.whatsapp.com/send?phone=&text={{idea.fullUrl | urlencode}}&source=&data=">WhatsApp</a></li>
							<li><a class="whatsapp mobile" href="whatsapp://send?text={{idea.fullUrl | urlencode}}" data-action="share/whatsapp/share">WhatsApp</a></li>
						</ul>
					</div>

				</div>
			</div>

		</div>
	</div>
</div>
<div class="pageContent idea clearfix">
	<div class="primary">
		<h1>{{idea.title}}</h1>

		<div id="author">
			<strong>Door: {{idea.user.firstName}} {{idea.user.lastName}}</strong><br>
			{{idea.startDate | date('LL')}}
		</div>

		{% include 'includes/modbreak.html' %}

		<div class="userContent">

			{% if idea.extraData.goal %}
				<strong>Wat willen we bereiken?</strong>
				<p>
					{{ idea.extraData.goal }}
				</p>
			{% endif %}

			{% if idea.extraData.method %}
				<strong>Wat gaan we doen?</strong>
				<p>
					{{ idea.extraData.method }}
				</p>
			{% endif %}

			{% if idea.extraData.who %}
				<strong>Wie zijn daarvoor nodig?</strong>
				<p>
					{{ idea.extraData.who }}
				</p>
			{% endif %}

			{% if idea.extraData.plans %}
				<strong>Dit agendapunt bestaat uit deze ideeÃ«n van bewoners:</strong>
				{% for plan in idea.extraData.plans %}
					<a hreg="{{ plan.link }}" target="_blank">{{ plan.title }}</a><br />
				{% endfor %}
			{% endif %}

		</div>

		{% if idea.location %}
			<br/><br/>
			{% if data.widget.mapType === 'googlemaps' %}
				<div id="mapcontainer">
					{% include 'includes/openstad-map.html' %}
				</div>
			{% endif %}
			{% if data.widget.mapType === 'openlayers' %}
			<div id="mapcontainer">
				{% include 'includes/openlayers-map.html' %}
			</div>
			{% endif %}
		{% endif %}

	</div> <!-- #primary -->

	<div class="secondary">
		{# <h2>Volgen</h2>

		<form action="/plan/{{idea.id}}/notify">
		<input type="submit" value="Mail updates">
		</form> #}

		{% if isOwnerOrAdmin%}
		{% include 'includes/crud/edit-delete.html' %}
		{% endif %}

		{% if data.isAdmin %}
		{% include 'includes/crud/admin.html' %}
		{% endif %}
	</div>
</div>
{% if data.isAdmin %}
{% include 'includes/modal-modbreak.html' %}
{% include 'includes/modal-vote-overview.html' %}
{% endif %}
